<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Live Classrooms - Nihongo Sekai</title>
    <meta
      name="description"
      content="Join live Japanese conversation classes with native speakers. Practice speaking in small groups and improve your fluency through real-time interaction."
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽŒ</text></svg>"
    />
  </head>
  <body>
    <!-- Navigation Header -->
    <header class="header">
      <nav class="navbar">
        <div class="container">
          <div class="nav-brand">
            <a href="index.html" class="brand-link">
              <span class="brand-icon">æ—¥</span>
              <span class="brand-text">
                <span class="brand-nihongo">Nihongo</span>
                <span class="brand-sekai">Sekai</span>
              </span>
            </a>
          </div>

          <div class="nav-menu" id="navMenu">
            <ul class="nav-list">
              <li><a href="index.html" class="nav-link">Home</a></li>
              <li><a href="courses.html" class="nav-link">Courses</a></li>
              <li>
                <a href="classrooms.html" class="nav-link active">Classrooms</a>
              </li>
              <li><a href="partners.html" class="nav-link">Partners</a></li>
              <li><a href="about.html" class="nav-link">About</a></li>
            </ul>
          </div>

          <div class="nav-actions">
            <a href="login.html" class="btn btn-outline">Sign In</a>
            <a href="signup.html" class="btn btn-primary">Get Started</a>
          </div>

          <button class="nav-toggle" id="navToggle">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
      </nav>
    </header>

    <!-- Main Content -->
    <main>
      <!-- Enhanced Hero Section with Gradient & Sakura Petals -->
      <section class="enhanced-hero">
        <div class="sakura-container" id="sakuraContainer">
          <!-- Sakura petals will be generated by JavaScript -->
        </div>
        <div class="container">
          <div class="enhanced-hero-content">
            <h1 class="enhanced-hero-title">Live Japanese Classrooms</h1>
            <p class="enhanced-hero-subtitle">
              Practice speaking with native teachers and fellow learners in
              real-time. Join interactive sessions designed to boost your
              conversation skills and cultural understanding.
            </p>
            <div class="enhanced-hero-stats">
              <div class="enhanced-stat">
                <span class="enhanced-stat-number">16+</span>
                <span class="enhanced-stat-label">Live Classrooms</span>
              </div>
              <div class="enhanced-stat">
                <span class="enhanced-stat-number">200+</span>
                <span class="enhanced-stat-label">Active Students</span>
              </div>
              <div class="enhanced-stat">
                <span class="enhanced-stat-number">4.8</span>
                <span class="enhanced-stat-label">Teacher Rating</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Sticky Search & Filter Section -->
      <section class="sticky-search-section" id="searchSection">
        <div class="container">
          <!-- Enhanced Search Bar -->
          <div class="enhanced-search-bar">
            <input
              type="text"
              id="classroomSearch"
              placeholder="Search live classrooms..."
              class="enhanced-search-input"
            />
            <svg
              class="enhanced-search-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
          </div>

          <!-- Filter Pills -->
          <div class="filter-pills">
            <div class="filter-pill" data-filter="level">
              <select id="levelFilter">
                <option value="">All Levels</option>
                <option value="Beginner">Beginner</option>
                <option value="Elementary">Elementary</option>
                <option value="Intermediate">Intermediate</option>
                <option value="Advanced">Advanced</option>
              </select>
            </div>

            <div class="filter-pill" data-filter="time">
              <select id="timeFilter">
                <option value="">All Times</option>
                <option value="morning">Morning (JST)</option>
                <option value="afternoon">Afternoon (JST)</option>
                <option value="evening">Evening (JST)</option>
              </select>
            </div>

            <div class="filter-pill" data-filter="focus">
              <select id="focusFilter">
                <option value="">All Topics</option>
                <option value="conversation">Conversation</option>
                <option value="grammar">Grammar</option>
                <option value="business">Business</option>
                <option value="culture">Culture</option>
                <option value="jlpt">JLPT Prep</option>
              </select>
            </div>

            <div class="filter-pill" data-filter="availability">
              <select id="availabilityFilter">
                <option value="">All Classes</option>
                <option value="available">Available</option>
                <option value="full">Full</option>
                <option value="starting-soon">Starting Soon</option>
              </select>
            </div>

            <button class="clear-filters-btn" id="clearFilters">
              Clear All
            </button>
          </div>
        </div>
      </section>

      <!-- Enhanced Classrooms Main Section -->
      <section class="classrooms-main">
        <div class="container">
          <!-- Results Summary -->
          <div style="text-align: center; margin-bottom: var(--spacing-xl)">
            <span
              id="resultsCount"
              style="
                font-size: 1.125rem;
                color: var(--color-gray-600);
                font-weight: 500;
              "
              >Loading classrooms...</span
            >
          </div>

          <!-- Enhanced Classroom Cards (6/page) -->
          <div class="enhanced-cards-grid" id="classroomsGrid">
            <!-- Classrooms will be loaded dynamically -->
          </div>

          <!-- Enhanced Pill-style Pagination -->
          <div class="enhanced-pagination" id="paginationWrapper">
            <button class="pagination-btn" id="prevPage" disabled>
              <svg
                viewBox="0 0 24 24"
                fill="currentColor"
                style="width: 16px; height: 16px"
              >
                <polyline points="15,18 9,12 15,6" />
              </svg>
              Previous
            </button>

            <div
              id="paginationNumbers"
              style="display: flex; gap: var(--spacing-sm)"
            >
              <!-- Page numbers will be generated dynamically -->
            </div>

            <button class="pagination-btn" id="nextPage">
              Next
              <svg
                viewBox="0 0 24 24"
                fill="currentColor"
                style="width: 16px; height: 16px"
              >
                <polyline points="9,18 15,12 9,6" />
              </svg>
            </button>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <div class="footer-brand">
              <span class="brand-icon">æ—¥</span>
              <span class="brand-text">Nihongo Sekai</span>
            </div>
            <p class="footer-description">
              Master Japanese through immersive conversations, cultural
              insights, and personalized learning paths with native speakers.
            </p>
          </div>

          <div class="footer-section">
            <h4 class="footer-title">Learning</h4>
            <ul class="footer-links">
              <li><a href="courses.html">Courses</a></li>
              <li><a href="classrooms.html">Classrooms</a></li>
              <li><a href="partners.html">Partners</a></li>
              <li><a href="pricing.html">Pricing</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h4 class="footer-title">Support</h4>
            <ul class="footer-links">
              <li><a href="help.html">Help Center</a></li>
              <li><a href="contact.html">Contact Us</a></li>
              <li><a href="community.html">Community</a></li>
              <li><a href="blog.html">Blog</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h4 class="footer-title">Company</h4>
            <ul class="footer-links">
              <li><a href="about.html">About Us</a></li>
              <li><a href="careers.html">Careers</a></li>
              <li><a href="press.html">Press</a></li>
              <li><a href="partners.html">Partners</a></li>
            </ul>
          </div>
        </div>

        <div class="footer-bottom">
          <p class="copyright">Â© 2024 Nihongo Sekai. All rights reserved.</p>
          <div class="footer-bottom-links">
            <a href="privacy.html">Privacy Policy</a>
            <a href="terms.html">Terms of Service</a>
            <a href="cookies.html">Cookie Policy</a>
          </div>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script>
      // Enhanced Classrooms page functionality
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize sakura petals animation
        initializeSakuraPetals();

        // Mock classroom data
        const classrooms = [
          {
            id: 1,
            title: "Morning Conversation Practice",
            description:
              "Join our morning conversation circle to practice speaking Japanese in a supportive environment. Perfect for beginners to intermediate learners.",
            image:
              "https://images.unsplash.com/photo-1491975474562-1f4e30bc9468?w=400&h=300&fit=crop",
            level: "Beginner",
            focus: "conversation",
            currentStudents: 5,
            maxStudents: 8,
            schedule: "Mon, Wed, Fri 9:00 AM JST",
            time: "morning",
            price: 25,
            instructor: "Yuki Tanaka",
            rating: 4.8,
            availability: "available",
          },
          {
            id: 2,
            title: "JLPT Study Group",
            description:
              "Intensive study sessions focused on JLPT preparation. We cover grammar, vocabulary, and practice tests together.",
            image:
              "https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=400&h=300&fit=crop",
            level: "Intermediate",
            focus: "jlpt",
            currentStudents: 7,
            maxStudents: 10,
            schedule: "Tue, Thu 7:00 PM JST",
            time: "evening",
            price: 30,
            instructor: "Hiroshi Sato",
            rating: 4.9,
            availability: "available",
          },
          {
            id: 3,
            title: "Business Japanese Workshop",
            description:
              "Advanced workshop for professionals. Practice business presentations, meetings, and formal communication in Japanese.",
            image:
              "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=400&h=300&fit=crop",
            level: "Advanced",
            focus: "business",
            currentStudents: 6,
            maxStudents: 6,
            schedule: "Sat 2:00 PM JST",
            time: "afternoon",
            price: 45,
            instructor: "Akiko Yamamoto",
            rating: 4.7,
            availability: "full",
          },
          {
            id: 4,
            title: "Anime Japanese Club",
            description:
              "Learn Japanese through popular anime and manga. Understand casual speech, slang, and cultural references.",
            image:
              "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",
            level: "Elementary",
            focus: "culture",
            currentStudents: 9,
            maxStudents: 12,
            schedule: "Sun 4:00 PM JST",
            time: "afternoon",
            price: 20,
            instructor: "Takeshi Morimoto",
            rating: 4.6,
            availability: "available",
          },
          {
            id: 5,
            title: "Grammar Bootcamp",
            description:
              "Intensive grammar sessions covering particles, verb forms, and complex sentence structures.",
            image:
              "https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop",
            level: "Intermediate",
            focus: "grammar",
            currentStudents: 4,
            maxStudents: 8,
            schedule: "Wed, Fri 6:00 PM JST",
            time: "evening",
            price: 35,
            instructor: "Mei Nakamura",
            rating: 4.8,
            availability: "starting-soon",
          },
          {
            id: 6,
            title: "Cultural Exchange Chat",
            description:
              "Relaxed conversation sessions focusing on Japanese culture, traditions, and modern life.",
            image:
              "https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?w=400&h=300&fit=crop",
            level: "Beginner",
            focus: "culture",
            currentStudents: 6,
            maxStudents: 10,
            schedule: "Sat 10:00 AM JST",
            time: "morning",
            price: 22,
            instructor: "Kenji Suzuki",
            rating: 4.5,
            availability: "available",
          },
        ];

        let filteredClassrooms = [...classrooms];
        let currentPage = 1;
        const classroomsPerPage = 6;
        const userEnrollments = ["1", "2"]; // Mock enrolled classrooms

        // Initialize page
        initializePage();

        function initializePage() {
          renderClassrooms();
          setupEventListeners();
          updateResultsCount();
          setupPagination();
          setupClassroomBehavior();
        }

        function initializeSakuraPetals() {
          const sakuraContainer = document.getElementById("sakuraContainer");

          // Create 9 sakura petals
          for (let i = 1; i <= 9; i++) {
            const petal = document.createElement("div");
            petal.className = "sakura-petal";
            sakuraContainer.appendChild(petal);
          }
        }

        function setupEventListeners() {
          // Search functionality
          document
            .getElementById("classroomSearch")
            .addEventListener("input", handleSearch);

          // Filter functionality with hover behavior
          setupFilterHoverBehavior();
          document
            .getElementById("levelFilter")
            .addEventListener("change", handleFilters);
          document
            .getElementById("timeFilter")
            .addEventListener("change", handleFilters);
          document
            .getElementById("focusFilter")
            .addEventListener("change", handleFilters);
          document
            .getElementById("availabilityFilter")
            .addEventListener("change", handleFilters);

          // Clear filters
          document
            .getElementById("clearFilters")
            .addEventListener("click", clearAllFilters);

          // Update filter chip states
          document.querySelectorAll(".filter-pill select").forEach((select) => {
            select.addEventListener("change", updateFilterChipState);
          });
        }

        function setupFilterHoverBehavior() {
          document.querySelectorAll(".filter-pill").forEach((pill) => {
            const select = pill.querySelector("select");

            pill.addEventListener("mouseenter", () => {
              if (select && !select.disabled) {
                select.focus();
              }
            });
          });
        }

        function handleSearch(e) {
          const searchTerm = e.target.value.toLowerCase();
          filteredClassrooms = classrooms.filter(
            (classroom) =>
              classroom.title.toLowerCase().includes(searchTerm) ||
              classroom.description.toLowerCase().includes(searchTerm) ||
              classroom.focus.toLowerCase().includes(searchTerm) ||
              classroom.instructor.toLowerCase().includes(searchTerm),
          );
          applyFiltersAndSort();
          currentPage = 1;
          renderClassrooms();
          updateResultsCount();
          setupPagination();
        }

        function handleFilters() {
          applyFiltersAndSort();
          currentPage = 1;
          renderClassrooms();
          updateResultsCount();
          setupPagination();
          updateClearButton();
        }

        function applyFiltersAndSort() {
          const level = document.getElementById("levelFilter").value;
          const time = document.getElementById("timeFilter").value;
          const focus = document.getElementById("focusFilter").value;
          const availability =
            document.getElementById("availabilityFilter").value;

          // Apply filters
          filteredClassrooms = classrooms.filter((classroom) => {
            const matchesSearch =
              !document.getElementById("classroomSearch").value ||
              classroom.title
                .toLowerCase()
                .includes(
                  document
                    .getElementById("classroomSearch")
                    .value.toLowerCase(),
                ) ||
              classroom.description
                .toLowerCase()
                .includes(
                  document
                    .getElementById("classroomSearch")
                    .value.toLowerCase(),
                );

            const matchesLevel = !level || classroom.level === level;
            const matchesTime = !time || classroom.time === time;
            const matchesFocus = !focus || classroom.focus === focus;
            const matchesAvailability =
              !availability || classroom.availability === availability;

            return (
              matchesSearch &&
              matchesLevel &&
              matchesTime &&
              matchesFocus &&
              matchesAvailability
            );
          });

          // Sort by availability (available first) then by rating
          filteredClassrooms.sort((a, b) => {
            if (
              a.availability === "available" &&
              b.availability !== "available"
            )
              return -1;
            if (
              a.availability !== "available" &&
              b.availability === "available"
            )
              return 1;
            return b.rating - a.rating;
          });
        }

        function clearAllFilters() {
          document.getElementById("classroomSearch").value = "";
          document.getElementById("levelFilter").value = "";
          document.getElementById("timeFilter").value = "";
          document.getElementById("focusFilter").value = "";
          document.getElementById("availabilityFilter").value = "";

          filteredClassrooms = [...classrooms];
          applyFiltersAndSort();
          currentPage = 1;
          renderClassrooms();
          updateResultsCount();
          setupPagination();
          updateClearButton();
          updateFilterChipStates();
        }

        function updateFilterChipState(e) {
          const pill = e.target.closest(".filter-pill");
          if (e.target.value) {
            pill.classList.add("active");
          } else {
            pill.classList.remove("active");
          }
          updateClearButton();
        }

        function updateFilterChipStates() {
          document.querySelectorAll(".filter-pill").forEach((pill) => {
            const select = pill.querySelector("select");
            if (select.value) {
              pill.classList.add("active");
            } else {
              pill.classList.remove("active");
            }
          });
        }

        function updateClearButton() {
          const hasActiveFilters =
            document.getElementById("classroomSearch").value ||
            document.getElementById("levelFilter").value ||
            document.getElementById("timeFilter").value ||
            document.getElementById("focusFilter").value ||
            document.getElementById("availabilityFilter").value;

          const clearBtn = document.getElementById("clearFilters");
          if (hasActiveFilters) {
            clearBtn.classList.add("visible");
          } else {
            clearBtn.classList.remove("visible");
          }
        }

        function renderClassrooms() {
          const startIndex = (currentPage - 1) * classroomsPerPage;
          const endIndex = startIndex + classroomsPerPage;
          const classroomsToShow = filteredClassrooms.slice(
            startIndex,
            endIndex,
          );

          const gridContainer = document.getElementById("classroomsGrid");
          gridContainer.innerHTML = classroomsToShow
            .map((classroom) => {
              const isEnrolled = userEnrollments.includes(
                classroom.id.toString(),
              );
              const progressPercentage = Math.round(
                (classroom.currentStudents / classroom.maxStudents) * 100,
              );
              const availabilityBadge = getAvailabilityBadge(
                classroom.availability,
              );

              return `
                <div class="enhanced-card" data-classroom-id="${classroom.id}">
                  <div class="enhanced-card-image">
                    <img src="${classroom.image}" alt="${classroom.title}" loading="lazy">
                    <div class="level-badge">${classroom.level}</div>
                    ${isEnrolled ? '<div class="purchased-badge">Enrolled</div>' : ""}
                    <div class="card-overlay">
                      <a href="classroom-detail.html?id=${classroom.id}" class="overlay-button" id="overlayButton-${classroom.id}">
                        <span class="button-text">Join Classroom</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M17 10.5V7a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-3.5l4 4v-11l-4 4z"></path>
                        </svg>
                      </a>
                    </div>
                  </div>
                  <div class="enhanced-card-content">
                    <h3 class="enhanced-card-title">${classroom.title}</h3>
                    <p class="enhanced-card-description">${classroom.description}</p>

                    <div class="instructor-info" onclick="viewInstructorProfile('${classroom.instructor}')">
                      <div class="instructor-avatar">
                        ${classroom.instructor
                          .split(" ")
                          .map((n) => n[0])
                          .join("")
                          .toUpperCase()}
                      </div>
                      <span class="instructor-name">${classroom.instructor}</span>
                    </div>

                    <div class="card-stats">
                      <div class="stats-left">
                        <div class="stat-item">
                          <span>ðŸ‘¥ ${classroom.currentStudents}/${classroom.maxStudents} enrolled</span>
                        </div>
                        <div class="stat-item">
                          <span>ðŸ—“ ${classroom.schedule}</span>
                        </div>
                      </div>
                      <div class="rating-display">
                        <div class="stars">${generateStars(classroom.rating)}</div>
                        <span>${classroom.rating}</span>
                      </div>
                    </div>

                    <!-- Progress Bar -->
                    <div style="margin-top: var(--spacing-md);">
                      <div style="display: flex; justify-content: space-between; margin-bottom: var(--spacing-xs); font-size: 0.875rem; color: var(--color-gray-600);">
                        <span>Enrollment</span>
                        <span>${progressPercentage}% full</span>
                      </div>
                      <div class="enrollment-progress">
                        <div class="progress-bar animated" style="width: ${progressPercentage}%"></div>
                      </div>
                      ${availabilityBadge}
                    </div>
                  </div>
                </div>
              `;
            })
            .join("");
        }

        function getAvailabilityBadge(availability) {
          const badges = {
            available:
              '<div style="margin-top: var(--spacing-sm); font-size: 0.75rem; color: var(--color-success); font-weight: 600;">âœ“ Available</div>',
            full: '<div style="margin-top: var(--spacing-sm); font-size: 0.75rem; color: var(--color-error); font-weight: 600;">âš« Full</div>',
            "starting-soon":
              '<div style="margin-top: var(--spacing-sm); font-size: 0.75rem; color: var(--color-warning); font-weight: 600;">ðŸ”¥ Starting Soon</div>',
          };
          return badges[availability] || "";
        }

        function generateStars(rating) {
          const fullStars = Math.floor(rating);
          const hasHalfStar = rating % 1 >= 0.5;
          let stars = "";

          for (let i = 0; i < fullStars; i++) {
            stars += "â˜…";
          }

          if (hasHalfStar) {
            stars += "â˜†";
          }

          return stars;
        }

        function updateResultsCount() {
          const count = filteredClassrooms.length;
          const countElement = document.getElementById("resultsCount");
          countElement.textContent = `${count} ${count === 1 ? "classroom" : "classrooms"} found`;
        }

        function setupPagination() {
          const totalPages = Math.ceil(
            filteredClassrooms.length / classroomsPerPage,
          );
          const paginationNumbers =
            document.getElementById("paginationNumbers");
          const prevBtn = document.getElementById("prevPage");
          const nextBtn = document.getElementById("nextPage");

          // Update button states
          prevBtn.disabled = currentPage === 1;
          nextBtn.disabled = currentPage === totalPages || totalPages === 0;

          // Generate page numbers
          paginationNumbers.innerHTML = "";
          for (let i = 1; i <= totalPages; i++) {
            const pageBtn = document.createElement("button");
            pageBtn.textContent = i;
            pageBtn.className = `pagination-number ${i === currentPage ? "active" : ""}`;
            pageBtn.addEventListener("click", () => goToPage(i));
            paginationNumbers.appendChild(pageBtn);
          }

          // Pagination navigation
          prevBtn.onclick = () => goToPage(currentPage - 1);
          nextBtn.onclick = () => goToPage(currentPage + 1);
        }

        function goToPage(page) {
          const totalPages = Math.ceil(
            filteredClassrooms.length / classroomsPerPage,
          );
          if (page < 1 || page > totalPages) return;

          currentPage = page;
          renderClassrooms();
          setupPagination();
          window.scrollTo({ top: 0, behavior: "smooth" });
        }

        // Global function for instructor profile viewing
        window.viewInstructorProfile = function (instructor) {
          // In a real app, this would navigate to instructor profile page
          console.log(`Viewing profile for: ${instructor}`);
          alert(`Viewing profile for ${instructor}`);
        };

        // Initialize filter chip states and clear button
        updateFilterChipStates();
        updateClearButton();

        function setupClassroomBehavior() {
          // Update hover behavior for Partners
          if (
            window.NihongoSekai &&
            window.NihongoSekai.updateClassroomCardBehavior
          ) {
            window.NihongoSekai.updateClassroomCardBehavior();
          }
        }
      });
    </script>
  </body>
</html>
